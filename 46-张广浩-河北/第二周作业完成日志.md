# 第二周作业完成日志

## 完成日期情况

四月23号完成了图像的最临近差值，双线性差值以及图像灰度均衡化处理。四月24日，完成了图像嗯彩色图像均值化处理。

## 各个任务流程介绍

+ 紧邻插值流程是，计算结算目标图像与原始图像的转换比率，按照该比率将目标图像中的各个像素点对应到原始图像中去，当前像素范围内较近的像素作为指定像素给目标图像像素值复制。

+ 双线性差值法进行同样的操作，再进行像素值计算时使用两次线性差值操作最终得到，该位置目标图像的像素值。

+ 灰度图均衡化处理，首先，对于一张图像计算灰度直方图，通过灰度直方图去计算，累计灰度直方图，之后，遍历该图像各个位置的像素点，通过公式去得到均衡化后，该位置的像素值，完成像素值的赋值之后，返回均衡化后的图像完成图像均值化操作。

## 任务完成情况问题与处理

### 彩色图均衡化流程和思路：

完成彩色图像均值化处理，嗯，流程与灰色图像处理流程近似，这是在这利的过程中在进行多一次的便利， 对于通道那个维度也进行便利去取得该通道的均衡化的像素值，再进行一个赋予初始化三通道之后的图像像素值的操作。这方面问题首先我考虑的是能不能不进行三次遍历，思路再确定均衡化后的像素值的过程中，需要用到该通道数的累加直方图，哪家直方图？一旦确定下来，最后在计算的过程中是不会改变的，所以具体的思路就是转换成一个三维的当派数组，第一维是通道数，第二维是零到256个向量，第三维是他们的值。处理的过程中，确定后两位的数字直接对第一维进行赋值。
最后还处理了一些问题，

### 近邻插值越界问题：

第一个问题是，嗯，在最近零差  值法中，目标位置像素映射到原始像素中数组越界问题，这问题，处理，借鉴了双线性差值法中，边界判断方法，当计算得到的像素点大于原始图像中的像素边界时，去计算结果与边界值减一中较小的那个值，作为真正的对应原始图像的像素位置值。这样解决了位置越界问题。

### 插值函数能够进行灰色和彩色按需插值问题处理

第二个问题，该问题针对两种插值方法，我们**想要的结果是**，输于将图像，不论是对于彩色图像还是灰色图像，都能够使用相同的代码段去进行差值处理。

但是过程中，我们**遇到的问题是**，对于三通道的图像像素去获取该图像数据的ship时，会有长宽通道三个维度的数据，但是对于open CV转换后的灰色图像，它会自动将最后的一个一通道给抹去，变成只有长宽维度的数据。

我想到的有一共有两种实现**解决方法**嗯，主要是去判断嗯像中是否有第三个维度的数据，热的实现应该可以使用ship中的lens去判断它的长度为二是v3v3，说明它是三维数据原二，说明它是二维灰度图像数据的，再进行不同的处理。

**具体实现：**但是在修改代码时，采用的是另一种方法，在函数参数中添加一个bool变量去指定嗯，我们需要在差值后差值成灰色图像还是彩色图像？如果是差值得到彩色图像，那么不用进行任何的处理，需要得到灰色图像，那么我们对于彩色图像调用库函数进行灰度化，灰度化后的图像只有长宽两个维度的数据，这时候，却通过查找发现了南派中向tensor操作中的unsqueeze或者view，可以将原始数组维度进行拓展，在灰度图的地方进行一个维度拓展，拓展一维的通道数，最后的处理便可以采用彩色图像处理的方法。这样的解决方法使得方法嗯，插值方法既可以处理彩色图像，又可以处理灰度图像。

### 双线性插值过程中，需要进行3次遍历，长、宽、通道，时间开销巨大。

**第三个问题**：是在双线性插值法中，通过观察，最近临近差值法中有处理数据的过程中，只对知识用两个破循环，对于强化宽度进行遍历即可，而最双线性差值法中，需要对于通道数，长度，宽度三个维度进行遍历。进行三次不循环，遍历所消耗的计算量和时间是巨大的。

**思路：**嗯，通过搜索，我在想能不能将嗯双线性差值法中三次或循环操作节省存两次循环，嗯，进行三次否循环操作，相当于对于图像的三个维度进行**串行处理**，处理完第一个维度后之后处理第二个维度再处理第三个维度，这样的速度是很慢的。我们可以使用两个for循环进行**并行处理**，因为数据是不发生变化的，我们所需要计算的只是位置信息和值信息，你确定了所要处理的位置信息后，也就是对应的xy坐标后，其值信息也是可以直接获取的，并且我们能同时直接获取三个维度的值信息，并且同时对于这三个维度的值信息进行处理以及赋值。

**具体实现：**嗯，具体到代码中的修改过程，直接将第一层的通道处循环给去掉，并且在图像处理过程中只使用xy两个维度确定像素点的位置，嗯，该像素点三个通道的数是可以自动进行赋值的。嗯，经过修改之后，原始的三次破循环所能处理的时间是20秒，修改成两次后，循环之后只需要七秒，速度大大提升。





最后我还对于各种插值的方法结果进行了对比，双线性插值需要的时间大于近邻插值，但是效果要好于近邻插值。任务中所有代码都是独立自己手工完成，提升了自己的编码水平。同时还遇到了很多问题，锻炼了自己的问题处理能力。